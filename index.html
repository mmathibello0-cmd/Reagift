<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Blueprint Love Puzzle</title>

<style>

body{
    margin:0;
    height:100vh;
    background:
      linear-gradient(135deg,#000000cc,#00000099),
      url("https://i.imgur.com/Rmd9Ns1.jpeg");
    background-size:cover;
    background-position:center;
    color:white;
    font-family:"Trebuchet MS",Arial,sans-serif;
    text-align:center;
    overflow:hidden;
}

/* ===== General UI ===== */
.center{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
}

h1{
    text-shadow: 0 0 12px gold;
}

input,button{
    padding:12px 18px;
    font-size:18px;
    border-radius:10px;
    border:none;
}

button{
    background:linear-gradient(45deg,gold,orange);
    box-shadow:0 0 12px gold;
    cursor:pointer;
}

/* ===== Screens ===== */
.screen{ display:none; }
.active{ display:block; }

/* ===== Puzzle ===== */
#puzzle{
    width:300px;
    height:300px;
    margin:auto;
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:4px;
}

.piece{
    background:url("https://i.imgur.com/KQsyAZ2.jpeg");
    background-size:300px 300px;
    border-radius:6px;
    cursor:pointer;
}

.empty{ background:none; }

#blueprintReveal{
    display:none;
    width:300px;
    height:300px;
    position:relative;
}

/* Blueprint Grid */
#blueprint{
    position:absolute;
    inset:0;
    background-color:#0c2447;
    background-image:
      linear-gradient(#ffffff22 1px, transparent 1px),
      linear-gradient(90deg, #ffffff22 1px, transparent 1px);
    background-size:20px 20px;
    opacity:1;
    animation:fadeOut 4s forwards;
}

/* Final Full Color Image */
#colorReveal{
    position:absolute;
    inset:0;
    background:url("https://i.imgur.com/KQsyAZ2.jpeg") center/cover;
    animation:drawIn 4s forwards;
}

/* Text fade */
#memoryText{
    margin-top:20px;
    animation:textFade 4s forwards;
}

@keyframes drawIn{
    0% { filter:grayscale(100%) brightness(40%); clip-path:inset(100% 0 0 0);}
    100% { filter:grayscale(0); clip-path:inset(0);}
}

@keyframes fadeOut{
    to{opacity:0;}
}

@keyframes textFade{
    from{opacity:0;}
    to{opacity:1;}
}

/* ===== Floating Effects ===== */
.sunflower{
    position:absolute;
    width:40px;
    height:40px;
    background:url("https://i.imgur.com/O9B0gXN.png") center/contain no-repeat;
    animation:floatUp linear infinite;
}

@keyframes floatUp{
   from{transform:translateY(110vh) rotate(0deg);}
   to{transform:translateY(-120px) rotate(360deg);}
}

/* ===== Message Screen ===== */
#messageScreen{
    background:#000000e8;
    position:absolute;
    inset:0;
    display:none;
}

/* Confetti */
canvas{
    position:absolute;
    inset:0;
    pointer-events:none;
}

</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginScreen" class="active center">
    <h1>üîê Enter The Portal</h1>
    <input type="password" id="password" placeholder="Password">
    <br><br>
    <button onclick="checkPassword()">OPEN ‚ù§Ô∏è</button>
</div>

<!-- GAME -->
<div id="gameScreen" class="screen center">
    <h2>üß© Build the Memory</h2>

    <div id="puzzle"></div>

    <div id="blueprintReveal">
        <div id="blueprint"></div>
        <div id="colorReveal"></div>
    </div>

    <p id="memoryText"></p>
</div>

<!-- LOVE LETTER -->
<div id="messageScreen">
    <div class="center">
        <h1>üíõ My Love Letter üíõ</h1>
        <p id="typingText"></p>
    </div>
    <canvas id="celebrate"></canvas>
</div>

<audio id="click" src="https://www.myinstants.com/media/sounds/minecraft_click.mp3"></audio>
<audio id="win" src="https://www.myinstants.com/media/sounds/anime-wow-sound-effect.mp3"></audio>

<script>

const PASSWORD="Pumpkin200925";

const memoryLine =
"üíõ Memory unlocked: I am glad I didn't get into the taxi.";

const loveMessage = `
To my favorite future Civil Engineer üèóÔ∏è,

Watching you build your dreams taught me this:
love is designed with patience, reinforced by trust,
and completed with commitment.

I am grateful for the day that crossed our journeys.
I am grateful I stayed ‚Äî and I am grateful for you.

üåª Always yours üåª
`;

/* ===== LOGIN ===== */
function checkPassword(){
if(password.value===PASSWORD){
    loginScreen.style.display="none";
    gameScreen.classList.add("active");
    startGame();
    floatSunflowers();
}
}

/* ===== PUZZLE ===== */
const puzzle=document.getElementById("puzzle");
let positions=[];

function startGame(){
positions=[...Array(9).keys()];
shuffle(positions);
draw();
}

function draw(){
puzzle.innerHTML="";
positions.forEach((p,i)=>{
 let d=document.createElement("div");
 d.className="piece";
 if(p===8) d.classList.add("empty");
 else{
    let x=(p%3)*100;
    let y=Math.floor(p/3)*100;
    d.style.backgroundPosition=`-${x}px -${y}px`;
 }
 d.onclick=()=>move(i);
 puzzle.appendChild(d);
});
checkWin();
}

function move(i){
click.play();
let e=positions.indexOf(8);
let moves=[e-1,e+1,e-3,e+3,e-4,e-2,e+2,e+4];

if(moves.includes(i)){
    [positions[i],positions[e]]=[positions[e],positions[i]];
    draw();
}
}

function checkWin(){
for(let i=0;i<9;i++){
 if(positions[i]!==i) return;
}
finish();
}

/* ===== BLUEPRINT EFFECT ===== */
function finish(){
puzzle.style.display="none";
document.getElementById("blueprintReveal").style.display="block";
memoryText.textContent=memoryLine;
win.play();

setTimeout(showLetter,3500);
}

/* ===== LOVE LETTER ===== */
function showLetter(){
gameScreen.style.display="none";
messageScreen.style.display="block";
confetti();
type();
}

/* ===== TYPE EFFECT ===== */
let ti=0;
function type(){
if(ti<loveMessage.length){
 typingText.textContent+=loveMessage.charAt(ti);
 ti++;
 setTimeout(type,40);
}
}

/* ===== FLOATING SUNFLOWERS ===== */
function floatSunflowers(){
for(let i=0;i<9;i++){
    let s=document.createElement("div");
    s.className="sunflower";
    s.style.left=Math.random()*90+"vw";
    s.style.animationDuration=(5+Math.random()*5)+"s";
    document.body.appendChild(s);
}
}

/* ===== CONFETTI ===== */
const ctx=celebrate.getContext("2d");
celebrate.width=innerWidth;
celebrate.height=innerHeight;
let c=[];

function confetti(){
for(let i=0;i<200;i++){
c.push({
 x:Math.random()*celebrate.width,
 y:-10,
 s:Math.random()*6+2,
 v:Math.random()*4+2
});
}
animate();
}

function animate(){
ctx.clearRect(0,0,celebrate.width,celebrate.height);
c.forEach(p=>{
ctx.fillRect(p.x,p.y,p.s,p.s);
p.y+=p.v;
if(p.y>celebrate.height) p.y=-10;
});
requestAnimationFrame(animate);
}

/* ===== SHUFFLE ===== */
function shuffle(a){
for(let i=a.length-1;i>0;i--){
 let j=Math.floor(Math.random()*(i+1));
 [a[i],a[j]]=[a[j],a[i]];
}
}

</script>

</body>
</html>
