<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Our Memory Puzzle üíõ</title>

<style>

body{
    margin:0;
    height:100vh;
    background:
      linear-gradient(135deg,#000000cc,#00000099),
      url("https://i.imgur.com/Rmd9Ns1.jpeg");
    background-size:cover;
    background-position:center;
    color:white;
    font-family:"Trebuchet MS",Arial,sans-serif;
    text-align:center;
    overflow:hidden;
}

.center{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
}

h1{
    text-shadow:0 0 10px gold;
}

input,button{
    padding:12px 18px;
    font-size:18px;
    border-radius:10px;
    border:none;
}

button{
   background:linear-gradient(45deg,gold,orange);
   box-shadow:0 0 12px gold;
   cursor:pointer;
}

.screen{display:none;}
.active{display:block}

/* ===== PUZZLE ===== */

#puzzle{
    width:300px;
    height:300px;
    margin:auto;
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:4px;
}

.piece{
    background:url("https://i.imgur.com/KQsyAZ2.jpeg");
    background-size:300px 300px;
    border-radius:6px;
    cursor:pointer;
}

.empty{background:none;}

/* ===== BLUEPRINT ===== */

#blueprintReveal{
    display:none;
    width:300px;
    height:300px;
    margin:auto;
    position:relative;
}

#blueprint{
    position:absolute;
    inset:0;
    background:#0c2447;
    background-image:
     linear-gradient(#ffffff22 1px, transparent 1px),
     linear-gradient(90deg,#ffffff22 1px, transparent 1px);
    background-size: 20px 20px;
    animation:fade 4s forwards;
}

#colorReveal{
    position:absolute;
    inset:0;
    background:url("https://i.imgur.com/KQsyAZ2.jpeg") center/cover;
    animation:draw 4s forwards;
}

@keyframes draw{
 from{filter:grayscale(100%) brightness(40%); clip-path:inset(100% 0 0 0);}
 to{filter:none; clip-path:inset(0);}
}

@keyframes fade{
 to{opacity:0;}
}

#memoryText{
    margin-top:15px;
    font-size:18px;
    animation:fadeTxt 3s forwards;
}

@keyframes fadeTxt{
 from{opacity:0;}
 to{opacity:1;}
}

/* ===== SUNFLOWERS ===== */

.sunflower{
    position:absolute;
    width:40px;
    height:40px;
    background:url("https://i.imgur.com/O9B0gXN.png") center/contain no-repeat;
    animation:floatUp linear infinite;
}

@keyframes floatUp{
   from{transform:translateY(110vh) rotate(0deg);}
   to{transform:translateY(-120px) rotate(360deg);}
}

/* ===== LOVE LETTER ===== */

#letterScreen{
    position:absolute;
    inset:0;
    background:#000000eb;
    display:none;
}

canvas{
    position:absolute;
    inset:0;
    pointer-events:none;
}

/* ===== REPLAY ===== */

#replayScreen{
    position:absolute;
    inset:0;
    background:#000000ee;
    display:none;
}

#finalPic{
    margin-top:40px;
    max-width:300px;
    border-radius:12px;
    box-shadow:0 0 15px gold;
}

</style>
</head>

<body>

<!-- LOGIN -->
<div id="login" class="screen active center">
<h1>üîê Enter the Portal</h1>
<input id="pass" type="password" placeholder="Password">
<br><br>
<button onclick="check()">UNLOCK ‚ù§Ô∏è</button>
</div>

<!-- GAME -->
<div id="game" class="screen center">
<h2>üß© Build the Memory</h2>
<div id="puzzle"></div>

<div id="blueprintReveal">
<div id="blueprint"></div>
<div id="colorReveal"></div>
</div>

<p id="memoryText"></p>
</div>

<!-- LETTER -->
<div id="letterScreen">
<div class="center">
<h1>üíõ My Love Letter üíõ</h1>
<p id="typing"></p>
<br><br>
<button onclick="replay()">üîÅ Tap To Replay Memory</button>
</div>
<canvas id="celebrate"></canvas>
</div>

<!-- REPLAY SCREEN -->
<div id="replayScreen" class="center">
<img id="finalPic" src="https://i.imgur.com/OdKMbqz.png">
<h2>üíõ To more smiles shared üíõ</h2>
</div>

<audio id="click" src="https://www.myinstants.com/media/sounds/minecraft_click.mp3"></audio>
<audio id="win" src="https://www.myinstants.com/media/sounds/anime-wow-sound-effect.mp3"></audio>

<script>

const PASSWORD = "Pumpkin200925";

const loveMessage = `
Hey my love,

We are officially 10 days away from your birthday,
which also marks 3 months since I met you ‚Äî my favorite person.

Thank you for being such a loving and caring spirit in my life.
You showed me that good still exists in this world.

Never stop shining and smiling.
You are destined for great things.

I can't wait to watch you grow into your best self.
Me and you until we go into the ground.

Remember: no weapon formed against you will prosper üíõ
`;

const memoryLine="üíõ I am glad I didn't get into the taxi";

/* ===== LOGIN ===== */
function check(){
if(pass.value===PASSWORD){
 login.style.display="none";
 game.classList.add("active");
 start();
 suns();
}
else alert("Wrong password üò≠");
}

/* ===== PUZZLE ===== */
const puzzle=document.getElementById("puzzle");
let pos=[];

function start(){
 pos=[...Array(9).keys()];
 shuffle(pos);
 draw();
}

function draw(){
 puzzle.innerHTML="";
 pos.forEach((p,i)=>{
  let d=document.createElement("div");
  d.className="piece";
  
  if(p===8){
   d.classList.add("empty");
  } else{
   let x=(p%3)*100;
   let y=Math.floor(p/3)*100;
   d.style.backgroundPosition=`-${x}px -${y}px`;
  }
  
  d.onclick=()=>move(i);
  puzzle.appendChild(d);
 });
 checkWin();
}

function move(i){
 click.play();
 let e=pos.indexOf(8);
 let moves=[e-1,e+1,e-3,e+3,e-4,e-2,e+2,e+4];

 if(moves.includes(i)){
  [pos[i],pos[e]]=[pos[e],pos[i]];
  draw();
 }
}

function checkWin(){
 for(let i=0;i<9;i++){
  if(pos[i]!==i) return;
 }
 finish();
}

/* ===== FINISH ===== */
function finish(){
 puzzle.style.display="none";
 blueprintReveal.style.display="block";
 memoryText.textContent=memoryLine;
 win.play();
 setTimeout(showLetter,3500);
}

/* ===== LETTER ===== */
let t=0;
function showLetter(){
 game.style.display="none";
 letterScreen.style.display="block";
 confetti();
 type();
}

function type(){
 if(t<loveMessage.length){
  typing.textContent+=loveMessage.charAt(t);
  t++;
  setTimeout(type,40);
 }
}

/* ===== REPLAY ===== */
function replay(){
 letterScreen.style.display="none";
 replayScreen.style.display="block";
}

/* ===== SUNFLOWERS ===== */
function suns(){
 for(let i=0;i<10;i++){
  let s=document.createElement("div");
  s.className="sunflower";
  s.style.left=Math.random()*90+"vw";
  s.style.animationDuration=(5+Math.random()*5)+"s";
  document.body.appendChild(s);
 }
}

/* ===== CONFETTI ===== */
const ctx=celebrate.getContext("2d");
celebrate.width=innerWidth;
celebrate.height=innerHeight;
let c=[];

function confetti(){
 for(let i=0;i<200;i++){
  c.push({
   x:Math.random()*celebrate.width,
   y:-10,
   s:Math.random()*4+2,
   v:Math.random()*3+2
  });
 }
 animate();
}

function animate(){
 ctx.clearRect(0,0,celebrate.width,celebrate.height);
 c.forEach(p=>{
  ctx.fillRect(p.x,p.y,p.s,p.s);
  p.y+=p.v;
  if(p.y>celebrate.height) p.y=-10;
 });
 requestAnimationFrame(animate);
}

/* ===== SHUFFLE ===== */
function shuffle(a){
 for(let i=a.length-1;i>0;i--){
  let j=Math.floor(Math.random()*(i+1));
  [a[i],a[j]]=[a[j],a[i]];
 }
}

</script>
</body>
</html>
